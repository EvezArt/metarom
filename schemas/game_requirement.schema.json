{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "schema://ucf/game_requirement.schema.json",
  "title": "UCF GameRequirement",
  "type": "object",
  "additionalProperties": false,
  "required": ["requirement_version","artifact_id","kind","source_type","targets_original","cpu","gpu","memory","runtime","io","timing","fidelity_modes","extractor_confidence"],
  "properties": {
    "requirement_version": {"type": "string", "pattern": "^0\\.1$"},
    "artifact_id": {"type": "string", "minLength": 1},
    "kind": {"type": "string", "enum": ["game_binary","game_source","workflow_app","emulator_core","other"]},
    "source_type": {"type": "string", "enum": ["binary_only","source_available","hybrid","unknown"]},
    "targets_original": {"type": "array", "minItems": 1, "items": {"type": "string"}},
    "cpu": {"type": "object", "additionalProperties": false, "required": ["required_isa","min_cores","threading_model"], "properties": {"required_isa": {"type": "array", "minItems": 1, "items": {"type": "string"}}, "min_cores": {"type": "integer", "minimum": 1}, "threading_model": {"type": "string", "enum": ["single_threaded","multi_threaded","unknown"]}, "simd_required": {"type": "array", "items": {"type": "string"}}, "perf_budget_hint": {"type": "object", "additionalProperties": false, "properties": {"frame_main_thread_ms": {"type": "number", "minimum": 0}, "frame_worker_ms": {"type": "number", "minimum": 0}}}}},
    "gpu": {"type": "object", "additionalProperties": false, "required": ["required_apis","features_required"], "properties": {"required_apis": {"type": "array", "items": {"type": "string"}}, "shader_model": {"type": "string"}, "features_required": {"type": "object", "additionalProperties": {"type": ["boolean","number","string"]}}, "vram_min_mb": {"type": "integer", "minimum": 0}}},
    "memory": {"type": "object", "additionalProperties": false, "required": ["ram_min_mb"], "properties": {"ram_min_mb": {"type": "integer", "minimum": 0}, "storage_install_mb": {"type": "integer", "minimum": 0}, "streaming_read_mbps": {"type": "number", "minimum": 0}, "seek_tolerance_ms": {"type": "number", "minimum": 0}}},
    "runtime": {"type": "object", "additionalProperties": false, "required": ["os_families"], "properties": {"os_families": {"type": "array", "items": {"type": "string"}}, "syscalls_or_apis": {"type": "array", "items": {"type": "string"}}, "middleware": {"type": "array", "items": {"type": "string"}}, "anti_cheat": {"type": "boolean"}, "drm": {"type": "string"}}},
    "io": {"type": "object", "additionalProperties": false, "required": ["required_inputs","online_required"], "properties": {"required_inputs": {"type": "array", "items": {"type": "string"}}, "online_required": {"type": "boolean"}}},
    "timing": {"type": "object", "additionalProperties": false, "properties": {"target_fps": {"type": "number", "minimum": 1}, "frame_pacing_sensitive": {"type": "boolean"}, "simulation_tick_hz": {"type": "number", "minimum": 1}}},
    "fidelity_modes": {
      "type": "array", "minItems": 1,
      "items": {
        "type": "object", "additionalProperties": false,
        "required": ["mode_id","priority","acceptable_equivalence_min"],
        "properties": {
          "mode_id": {"type": "string"},
          "priority": {"type": "string", "enum": ["gameplay","latency","visual","archival","balanced"]},
          "acceptable_equivalence_min": {"type": "string", "enum": ["L0_BOOT","L1_STABLE","L2_INTERACTIVE","L3_GAMEPLAY_EQ","L4_RENDER_EQ","L5_BIT_EXACT"]},
          "split_execution": {
            "type": "object", "additionalProperties": false,
            "properties": {
              "preferred_mode": {"type": "string", "enum": ["streaming_full","hybrid_prediction","split_ui_local","split_audio_local"]},
              "rollback_window_frames_min": {"type": "integer", "minimum": 0, "maximum": 20},
              "rollback_window_frames_target": {"type": "integer", "minimum": 0, "maximum": 20},
              "rollback_window_frames_max": {"type": "integer", "minimum": 0, "maximum": 30},
              "latency_budget_ms_override": {"type": "number", "minimum": 0}
            }
          }
        }
      }
    },
    "extractor_confidence": {"type": "object", "additionalProperties": false, "required": ["static_analysis","runtime_probe","trace_inference"], "properties": {"static_analysis": {"type": "number", "minimum": 0, "maximum": 1}, "runtime_probe": {"type": "number", "minimum": 0, "maximum": 1}, "trace_inference": {"type": "number", "minimum": 0, "maximum": 1}}}
  }
}